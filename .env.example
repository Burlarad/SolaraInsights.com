# ==============================================================================
# SOLARA INSIGHTS - ENVIRONMENT VARIABLES
# ==============================================================================
# Copy this file to .env.local and fill in your actual values.
# Never commit .env.local to version control.
#
# ENVIRONMENT TEMPLATES:
#   - .env.local.example     → Local development with local Supabase
#   - .env.production.example → Cloud deployment (Render, Vercel)
#
# LOCAL DEVELOPMENT QUICK START:
#   1. Copy .env.local.example to .env.local
#   2. Run: npm run supabase:local:start
#   3. Run: npm run supabase:local:status
#   4. Copy the anon key and service_role key from output to .env.local
#   5. Run: npm run dev
#
# CLOUD DEPLOYMENT:
#   - Set NEXT_PUBLIC_SITE_URL to your production domain
#   - Use live Stripe keys instead of test keys
#   - Get Supabase keys from Dashboard > Settings > API

# ==============================================================================
# CORE APPLICATION URLS
# ==============================================================================
# NEXT_PUBLIC_SITE_URL: Primary URL for OAuth callback construction
# - Must match EXACTLY what's registered in provider portals (Facebook, TikTok, X, etc.)
# - Format: https://yourdomain.com (no trailing slash)
# - Used in: lib/social/oauth.ts, all OAuth callback routes
NEXT_PUBLIC_SITE_URL=http://localhost:3000

# NEXT_PUBLIC_APP_URL: Used for auth redirects (sign-in, sign-up, Stripe)
# - Falls back to window.location.origin in browser
NEXT_PUBLIC_APP_URL=http://localhost:3000

# Legacy URL vars (for backward compatibility - can be removed if not used)
APP_URL=http://localhost:3000

# ==============================================================================
# SUPABASE CONFIGURATION
# ==============================================================================
# Get these from: Supabase Dashboard > Settings > API (cloud)
# Or from: npm run supabase:local:status (local development)
#
# LOCAL DEVELOPMENT:
#   NEXT_PUBLIC_SUPABASE_URL=http://127.0.0.1:54321
#   Copy anon key and service_role key from `supabase status` output
#
# CLOUD (production/staging):
#   NEXT_PUBLIC_SUPABASE_URL=https://<project-ref>.supabase.co
#   Get keys from Supabase Dashboard > Settings > API

# Public URL and anon key (safe for client-side)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key

# Service Role Key (ADMIN ACCESS - bypasses RLS)
# CRITICAL: Never expose this in browser/client code - server-side only!
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# ==============================================================================
# OPENAI CONFIGURATION
# ==============================================================================
# Get your API key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-proj-your-openai-api-key

# Model Configuration (cost optimization by use case)
# Daily insights (today timeframe, connection briefs, public endpoints) - fast, cheap
OPENAI_DAILY_INSIGHTS_MODEL=gpt-4.1-mini
OPENAI_HOROSCOPE_MODEL=gpt-4.1-mini
OPENAI_CONNECTION_BRIEF_MODEL=gpt-4.1-mini

# Premium content (cached long-term) - higher quality
OPENAI_YEARLY_INSIGHTS_MODEL=gpt-5.1
OPENAI_BIRTHCHART_MODEL=gpt-5.1
OPENAI_INSIGHTS_MODEL=gpt-5.1
OPENAI_PLACEMENTS_MODEL=gpt-5.1

# Deep analysis (Space Between connections) - quarterly refresh
OPENAI_DEEP_MODEL=gpt-4o

# Social summaries - lightweight
OPENAI_FAST_MODEL=gpt-4o-mini

# ==============================================================================
# STRIPE CONFIGURATION
# ==============================================================================
# Get these from: Stripe Dashboard > Developers > API keys
# Use sk_test_ and pk_test_ keys for development

# Server-side keys (never expose to client)
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret
STRIPE_PRICE_ID=price_your-sanctuary-price-id
STRIPE_FAMILY_PRICE_ID=price_your-family-price-id
STRIPE_PRICING_TABLE_ID=prctbl_your-pricing-table-id

# Client-side keys (required for /join page Stripe Pricing Table embed)
# These MUST have NEXT_PUBLIC_ prefix to be available in browser
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_your-stripe-publishable-key
NEXT_PUBLIC_STRIPE_PRICING_TABLE_ID=prctbl_your-pricing-table-id

# ==============================================================================
# EMAIL CONFIGURATION (RESEND)
# ==============================================================================
# Get your API key from: https://resend.com
RESEND_API_KEY=re_your-resend-api-key
RESEND_FROM="Solara Insights <solara@yourdomain.com>"

# ==============================================================================
# REDIS/VALKEY (CACHING & RATE LIMITING)
# ==============================================================================
# Optional - leave empty to disable Redis features (rate limiting, caching)
# For Render: Use the Internal URL from your Redis/Valkey service
REDIS_URL=

# ==============================================================================
# SOCIAL OAUTH PROVIDERS
# ==============================================================================
# All providers use Authorization Code + PKCE (S256) flow
# Callback URL format: {NEXT_PUBLIC_SITE_URL}/api/social/oauth/{provider}/callback
# Login callback format: {NEXT_PUBLIC_SITE_URL}/api/auth/login/{provider}/callback

# ---- Meta (Facebook + Instagram) ----
# Register at: https://developers.facebook.com/apps
# Uses same Meta app for both Facebook and Instagram
META_APP_ID=your-meta-app-id
META_APP_SECRET=your-meta-app-secret

# ---- TikTok ----
# Register at: https://developers.tiktok.com/
# Scopes: user.info.basic (MVP - auto-approved in sandbox)
TIKTOK_CLIENT_KEY=your-tiktok-client-key
TIKTOK_CLIENT_SECRET=your-tiktok-client-secret

# ---- X (Twitter) ----
# Register at: https://developer.twitter.com/
# Scopes: users.read (Free tier)
# Feature-flagged - set X_OAUTH_ENABLED=true to enable
X_CLIENT_ID=your-x-client-id
X_CLIENT_SECRET=your-x-client-secret
X_OAUTH_ENABLED=false
# Client-side mirror for UI components (Settings page, Welcome page)
NEXT_PUBLIC_X_OAUTH_ENABLED=false

# ---- Reddit ----
# Register at: https://www.reddit.com/prefs/apps
# Not yet configured
REDDIT_CLIENT_ID=
REDDIT_CLIENT_SECRET=

# ---- Token Encryption ----
# AES-256-GCM encryption key for storing OAuth tokens securely
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
SOCIAL_TOKEN_ENCRYPTION_KEY=your-base64-encoded-32-byte-key

# ==============================================================================
# SECURITY & AUTHENTICATION
# ==============================================================================
# Generate with: openssl rand -base64 32
AUTH_SECRET=your-auth-secret

# Secret for securing cron/internal API endpoints
CRON_SECRET=your-cron-secret

# ==============================================================================
# DEBUG & DEVELOPMENT
# ==============================================================================
NODE_ENV=development

# Debug mode - shows additional UI indicators
NEXT_PUBLIC_SOLARA_DEBUG=1

# Dev paywall bypass - skip payment + onboarding gates for testing
# HARD SAFETY: Automatically ignored if NODE_ENV=production OR on solarainsights.com
# Shows orange banner when active
DEV_PAYWALL_BYPASS=false

# OAuth Debug Logs - Enable verbose OAuth flow logging
# Set to "true" when debugging OAuth issues with any provider
# Logs: redirect URIs, auth URLs, PKCE status, token exchange details
# IMPORTANT: Set to false in production!
OAUTH_DEBUG_LOGS=false
